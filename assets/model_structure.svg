<?xml version="1.0" encoding="UTF-8"?>
<svg width="1000" height="520" viewBox="0 0 1000 520" xmlns="http://www.w3.org/2000/svg">
  <style>
    .box { fill:#f7f9fc; stroke:#2b6cb0; stroke-width:2; rx:8; }
    .label { font-family: Arial, Helvetica, sans-serif; font-size:14px; fill:#0b2a66; }
    .small { font-size:12px; fill:#123; }
    .arrow { stroke:#2b6cb0; stroke-width:2; fill:none; marker-end: url(#arrowhead); }
  </style>
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#2b6cb0" />
    </marker>
  </defs>

  <!-- Input -->
  <rect x="30" y="40" width="220" height="80" class="box" />
  <text x="45" y="68" class="label">User Symptom Text</text>
  <text x="45" y="88" class="small">(visuals: leaf spots, yellowing, weather notes)</text>

  <!-- Preprocessing -->
  <rect x="300" y="30" width="200" height="100" class="box" />
  <text x="320" y="60" class="label">Text Preprocessing</text>
  <text x="320" y="82" class="small">tokenize, lowercase, strip</text>

  <!-- Encoder -->
  <rect x="560" y="20" width="360" height="130" class="box" />
  <text x="580" y="52" class="label">SentenceTransformer Encoder</text>
  <text x="580" y="74" class="small">Base model: all-MiniLM-L6-v2</text>
  <text x="580" y="96" class="small">Transformer token embeddings -> mean pooling</text>

  <!-- arrows -->
  <path d="M250 80 L300 80" class="arrow" />
  <path d="M500 80 L560 80" class="arrow" />

  <!-- Embedding -->
  <rect x="300" y="170" width="250" height="80" class="box" />
  <text x="315" y="200" class="label">Sentence Embedding (d)</text>
  <text x="315" y="222" class="small">512 / 384 dims (model dependent)</text>

  <!-- Training head -->
  <rect x="600" y="180" width="320" height="80" class="box" />
  <text x="620" y="204" class="label">Softmax Classifier (training)</text>
  <text x="620" y="226" class="small">Small MLP head: num_labels -> SoftmaxLoss</text>

  <path d="M475 210 L600 210" class="arrow" />

  <!-- Inference path -->
  <rect x="300" y="280" width="680" height="200" fill="#fff" stroke="#cbd5e1" rx="8" />
  <text x="320" y="306" class="label">Inference (App)</text>

  <rect x="320" y="330" width="220" height="60" class="box" />
  <text x="340" y="360" class="label">Query Embedding</text>

  <rect x="580" y="330" width="360" height="60" class="box" />
  <text x="600" y="360" class="label">Corpus Embeddings</text>
  <text x="600" y="380" class="small">(pre-computed from disease descriptions)</text>

  <path d="M460 360 L580 360" class="arrow" />

  <rect x="320" y="410" width="620" height="60" class="box" />
  <text x="340" y="440" class="label">Cosine Similarity + Top-K Retrieval</text>
  <text x="340" y="462" class="small">Return top match(es) with confidence score</text>

  <!-- arrows from encoder to embedding and inference -->
  <path d="M740 140 L740 170" class="arrow" />
  <path d="M740 170 L560 170" class="arrow" />
  <path d="M560 170 L560 230" class="arrow" />

  <!-- Legend -->
  <text x="40" y="480" class="small">Training: encoder -> embedding -> softmax head (SoftmaxLoss)</text>
  <text x="40" y="500" class="small">Inference: query embedding vs corpus embeddings -> cosine similarity -> top-k</text>

</svg>